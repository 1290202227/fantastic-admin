
/**
 * name: Fantastic-admin
 * homepage: https://hooray.gitee.io/fantastic-admin/
 */
    
import{n as e,q as t,K as s,r as i,a as l,s as a,y as r,z as n,c as o,I as p,t as c,D as u,v as d,x as h,A as g,W as f}from"./vendor.505a4e11.js";e("data-v-492290fb");const v={class:"upload-container"},y=c("div",{class:"image-slot"},[c("i",{class:"el-icon-plus"})],-1),m={key:1,class:"image"},w={class:"mask"},b={class:"actions"},x=[c("i",{class:"el-icon-zoom-in"},null,-1)],$=["onClick"],k=[c("i",{class:"el-icon-delete"},null,-1)],V={key:0,class:"el-upload__tip"},j={style:{display:"inline-block"}};t();const z={props:{action:{type:String,required:!0},headers:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},name:{type:String,default:"file"},url:{type:String,default:""},size:{type:Number,default:2},width:{type:Number,default:150},height:{type:Number,default:150},placeholder:{type:String,default:""},notip:{type:Boolean,default:!1},ext:{type:Array,default:()=>["jpg","png","gif","bmp"]}},emits:["update:url","on-success"],setup(e,{emit:t}){const z=e,{proxy:_}=f(),C=s({imageViewerVisible:!1,progress:{preview:"",percent:0}});function O(){C.value.imageViewerVisible=!1}function S(){t("update:url","")}function B(e){const t=e.name.split("."),s=t[t.length-1],i=z.ext.indexOf(s)>=0,l=e.size/1024/1024<z.size;return i||_.$message.error(`上传图片只支持 ${z.ext.join(" / ")} 格式！`),l||_.$message.error(`上传图片大小不能超过 ${z.size}MB！`),i&&l&&(C.value.progress.preview=URL.createObjectURL(e)),i&&l}function M(e){C.value.progress.percent=~~e.percent,100==C.value.progress.percent&&setTimeout((()=>{C.value.progress.preview="",C.value.progress.percent=0}),1e3)}function N(e){t("on-success",e)}return(t,s)=>{const f=i("el-image"),z=i("el-progress"),_=i("el-upload"),q=i("el-alert"),A=i("el-image-viewer");return l(),a("div",v,[r(_,{"show-file-list":!1,headers:e.headers,action:e.action,data:C.value,name:e.name,"before-upload":B,"on-progress":M,"on-success":N,drag:""},{default:n((()=>[""===e.url?(l(),o(f,{key:0,src:""===e.url?e.placeholder:e.url,style:p(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},{error:n((()=>[y])),_:1},8,["src","style"])):(l(),a("div",m,[r(f,{src:e.url,style:p(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),c("div",w,[c("div",b,[c("span",{title:"预览",onClick:s[0]||(s[0]=u((e=>t.imageViewerVisible=!0),["stop"]))},x),c("span",{title:"移除",onClick:u(S,["stop"])},k,8,$)])])])),d(c("div",{class:"progress",style:p(`width:${e.width}px;height:${e.height}px;`)},[r(f,{src:C.value.progress.preview,style:p(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),r(z,{type:"circle",width:.8*Math.min(e.width,e.height),percentage:C.value.progress.percent},null,8,["width","percentage"])],4),[[h,C.value.progress.percent]])])),_:1},8,["headers","action","data","name"]),e.notip?g("v-if",!0):(l(),a("div",V,[c("div",j,[r(q,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，且图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),C.value.imageViewerVisible?(l(),o(A,{key:1,"url-list":[e.url],onClose:O},null,8,["url-list"])):g("v-if",!0)])}},__scopeId:"data-v-492290fb"};export{z as _};

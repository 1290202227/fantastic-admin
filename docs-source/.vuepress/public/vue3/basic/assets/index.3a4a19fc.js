
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{L as e,r as t,a as s,n as i,t as l,x as a,c as r,J as n,q as p,F as o,s as c,v as u,y as d,A as h,B as g,X as f}from"./vendor.e08917c3.js";import{_ as v}from"./plugin-vue_export-helper.5a098b48.js";const m=e=>(h("data-v-6f6b780a"),e=e(),g(),e),y={class:"upload-container"},w=m((()=>p("div",{class:"image-slot"},[p("i",{class:"el-icon-plus"})],-1))),b={key:1,class:"image"},x={class:"mask"},$={class:"actions"},k=[m((()=>p("i",{class:"el-icon-zoom-in"},null,-1)))],_=["onClick"],j=[m((()=>p("i",{class:"el-icon-delete"},null,-1)))],V={key:0,class:"el-upload__tip"},z={style:{display:"inline-block"}};var B=v({props:{action:{type:String,required:!0},headers:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},name:{type:String,default:"file"},url:{type:String,default:""},size:{type:Number,default:2},width:{type:Number,default:150},height:{type:Number,default:150},placeholder:{type:String,default:""},notip:{type:Boolean,default:!1},ext:{type:Array,default:()=>["jpg","png","gif","bmp"]}},emits:["update:url","on-success"],setup(h,{emit:g}){const v=h,{proxy:m}=f(),B=e({imageViewerVisible:!1,progress:{preview:"",percent:0}});function C(){B.value.imageViewerVisible=!1}function O(){g("update:url","")}function S(e){const t=e.name.split("."),s=t[t.length-1],i=v.ext.indexOf(s)>=0,l=e.size/1024/1024<v.size;return i||m.$message.error(`上传图片只支持 ${v.ext.join(" / ")} 格式！`),l||m.$message.error(`上传图片大小不能超过 ${v.size}MB！`),i&&l&&(B.value.progress.preview=URL.createObjectURL(e)),i&&l}function L(e){B.value.progress.percent=~~e.percent,100==B.value.progress.percent&&setTimeout((()=>{B.value.progress.preview="",B.value.progress.percent=0}),1e3)}function M(e){g("on-success",e)}return(e,g)=>{const f=t("el-image"),v=t("el-progress"),m=t("el-upload"),N=t("el-alert"),q=t("el-image-viewer");return s(),i("div",y,[l(m,{"show-file-list":!1,headers:h.headers,action:h.action,data:B.value,name:h.name,"before-upload":S,"on-progress":L,"on-success":M,drag:""},{default:a((()=>[""===h.url?(s(),r(f,{key:0,src:""===h.url?h.placeholder:h.url,style:n(`width:${h.width}px;height:${h.height}px;`),fit:"fill"},{error:a((()=>[w])),_:1},8,["src","style"])):(s(),i("div",b,[l(f,{src:h.url,style:n(`width:${h.width}px;height:${h.height}px;`),fit:"fill"},null,8,["src","style"]),p("div",x,[p("div",$,[p("span",{title:"预览",onClick:g[0]||(g[0]=o((t=>e.imageViewerVisible=!0),["stop"]))},k),p("span",{title:"移除",onClick:o(O,["stop"])},j,8,_)])])])),c(p("div",{class:"progress",style:n(`width:${h.width}px;height:${h.height}px;`)},[l(f,{src:B.value.progress.preview,style:n(`width:${h.width}px;height:${h.height}px;`),fit:"fill"},null,8,["src","style"]),l(v,{type:"circle",width:.8*Math.min(h.width,h.height),percentage:B.value.progress.percent},null,8,["width","percentage"])],4),[[u,B.value.progress.percent]])])),_:1},8,["headers","action","data","name"]),h.notip?d("v-if",!0):(s(),i("div",V,[p("div",z,[l(N,{title:`上传图片支持 ${h.ext.join(" / ")} 格式，且图片大小不超过 ${h.size}MB，建议图片尺寸为 ${h.width}*${h.height}`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),B.value.imageViewerVisible?(s(),r(q,{key:1,"url-list":[h.url],onClose:C},null,8,["url-list"])):d("v-if",!0)])}}},[["__scopeId","data-v-6f6b780a"]]);export{B as _};
